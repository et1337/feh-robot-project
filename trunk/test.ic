#use "constants_lib.ic"
#use "encoder_lib.ic"
#use "movement_lib.ic"
#use "implement_lib.ic"
#use "general_lib.ic"

int main()
{
    int startLightValue = 0;
    int leftLineFloorValue;
    int centerLineFloorValue;
    int rightLineFloorValue;
    int knobValue;
    
    initServo(implementServo);
    initEncoders(); 

    
    implement(IMPLEMENT_UP);
    
    startLightValue = analog(startLightPort);
    leftLineFloorValue = analog(leftLinePort);
    centerLineFloorValue = analog(centerLinePort);
    rightLineFloorValue = analog(rightLinePort);
    
    
    // Wait for start light or start button.
    while(!start_button())
      {
        sleep(0.1);
        knobValue = knob() /23; // value of 0 to 10
        switch (knobValue)
          {
            case 0: printf("0: From Start\n"); break;
            case 1: printf("1: Depress Plunger\n"); break;
            case 2: printf("2: Get Gem\n"); break;
            default: printf("Default: Full routine\n"); knobValue = 0; break;
        }
    }
    switch (knobValue)
      {
        case 0: // Everything
          WaitForStartLight(startLightValue);
          DropOffDynamite();
        case 1: // Press plunger
          DepressPlunger(leftLineFloorValue, centerLineFloorValue, rightLineFloorValue);
        case 2:
          sleep(1.0);
          GetGem(leftLineFloorValue, centerLineFloorValue, rightLineFloorValue);   
    }
    
    exp_servo_disable();
}
